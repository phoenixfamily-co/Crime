{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" dir="{% if LANGUAGE_BIDI %}rtl{% else %}ltr{% endif %}">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow"> <!-- Ø§Ø¬Ø§Ø²Ù‡ Ø§ÛŒÙ†Ø¯Ú©Ø³ Ùˆ Ø¯Ù†Ø¨Ø§Ù„ Ú©Ø±Ø¯Ù† Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ -->
    <title>{% trans 'Ø¬ÙˆØ§Ø¨ Ø¯Ø±Ø³Øª' %}</title> <!-- Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>

         :root {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --navbar-bg: #1e1e1e;
            --navbar-border: #d32f2f;
            --nav-link-color: #e0e0e0;
            --nav-link-hover: #d32f2f;
            --btn-bg: #d32f2f;
            --btn-hover: #ff6659;
            --btn-text: #ffffff;
            --text-color-muted: #e1e1e1; /* Ø±Ù†Ú¯ Ø®Ø§Ú©Ø³ØªØ±ÛŒ Ø±ÙˆØ´Ù†â€ŒØªØ± Ø¨Ø±Ø§ÛŒ Ø­Ø§Ù„Øª Ø¯Ø§Ø±Ú© */
            --navbar-toggler-border-color-dark: #666; /* Ø±Ù†Ú¯ Ø­Ø§Ø´ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ø­Ø§Ù„Øª Ø¯Ø§Ø±Ú© */
            --navbar-toggler-bg-color-dark: #333; /* Ø±Ù†Ú¯ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø­Ø§Ù„Øª Ø¯Ø§Ø±Ú© */
            --navbar-toggler-icon-color-dark: #fff; /* Ø±Ù†Ú¯ Ø§ÛŒÚ©ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ø­Ø§Ù„Øª Ø¯Ø§Ø±Ú© */
        }

         body {
             justify-content: center;
             align-items: center;
             margin: 0;
             background-color: var(--bg-color)!important;
             color: var(--text-color)!important;
             font-family: Arial, sans-serif;
             transition: background-color 0.3s, color 0.3s;

      }

         .card{
             background-color: var(--navbar-bg)!important;
         }

         .btn{
             background-color: var(--btn-bg);
             color: var(--btn-text);
         }

         form .form-control {
            background-color: transparent;
            color: var(--btn-text)!important;
            outline: none;
            box-shadow: none;
        }
        form .form-control:focus {
            background-color: transparent;
            border-color:#d32f2f;
            color: var(--btn-text)!important;
            outline: none;
            box-shadow: none;
        }


    </style>
</head>

<body>
    <div class="container py-5">
        <!-- Header -->
       <div class="text-center mb-4">
            <h1 id="result-message" class="fw-bold">ØªØ¨Ø±ÛŒÚ© Ø´Ù…Ø§ Ø¯Ø±Ø³Øª Ø¬ÙˆØ§Ø¨ Ø¯Ø§Ø¯ÛŒØ¯ ğŸ‰</h1>
            <p id="result-description" class="fs-5">Ø´Ù…Ø§ Ø§ÛŒÙ† Ù¾Ø±ÙˆÙ†Ø¯Ù‡ Ø±Ùˆ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ù„ Ú©Ø±Ø¯ÛŒØ¯</p>
        </div>

        <!-- Feedback Form -->
       <div class="card text-light mb-4">
            <div class="card-body">
                <h5 class="card-title text-center">Ù…Ø´ØªØ§Ù‚Ø§Ù†Ù‡ Ù…Ù†ØªØ¸Ø± Ø´Ù†ÛŒØ¯Ù† Ù†Ø¸Ø±Ù‡Ø§ÛŒØªØ§Ù† Ù‡Ø³ØªÛŒÙ… ğŸ˜</h5>
                <form id="commentForm">
                    <div class="mb-3">
                        <label for="name" class="form-label">Ù†Ø§Ù…</label>
                        <input type="text" class="form-control" id="name" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                    </div>

                     <div class="mb-3">
                        <label for="family" class="form-label">Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                        <input type="text" class="form-control" id="family" placeholder="Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                    </div>

                    <div class="mb-3">
                        <label for="number" class="form-label">Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³</label>
                        <input type="text" class="form-control" id="number" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ù‡Ù…Ø±Ø§Ù‡ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                    </div>

                    <div class="mb-3">
                        <label for="userFeedback" class="form-label">Ù†Ø¸Ø± Ø´Ù…Ø§</label>
                        <textarea class="form-control" id="userFeedback" rows="3" placeholder="Ù†Ø¸Ø±Øª Ø±Ùˆ Ø¨Ø§ Ù…Ø§ Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ø²Ø§Ø±" required></textarea>
                    </div>

                    <button type="submit" class="btn">Ø§Ø±Ø³Ø§Ù„ Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯</button>
                </form>
            </div>
        </div>

         <!-- Case Summary -->
        <div class="card bg-secondary text-light mb-4">
            <div class="card-body">
                <h5 class="card-title">Ø®Ù„Ø§ØµÙ‡ Ø¯Ø§Ø¯Ù†Ø§Ù…Ù‡</h5>
                <p id="case-details" class="card-text">{{ case.result | linebreaks }}</p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="text-center">
            <a href="{% url 'product:play-view' case.id %}" class="btn btn-success me-2">Ø¨Ø§Ø²ÛŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡</a>
            <a href="{% url 'home:home-view' %}" class="btn btn-outline-light">ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>

         document.getElementById('commentForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø±ÙØªØ§Ø± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù…

           const commentData = {
               name: document.getElementById('name').value,
               family: document.getElementById('family').value,
               number: document.getElementById('number').value,
               description: document.getElementById('userFeedback').value,
               score: 5, // Ø§Ù…ØªÛŒØ§Ø²
               case: '{{ case.id }}' // Ø¢ÛŒâ€ŒØ¯ÛŒ Ù…ÙˆØ±Ø¯ (ÛŒØ§ Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ù‚Ø¹ÛŒ Ø±Ø§ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯)
           };

            // Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ API
            fetch('{% url 'product:comment-list' %}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                  body: JSON.stringify(commentData),

            })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(data => {
                    throw new Error(data.detail || 'Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ù†Ø¸Ø±');
                });
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Ù†Ø¸Ø± Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯');
                })
                .catch(error => {
                    alert('Ø®Ø·Ø§: ' + error.message);
                    console.error(error);
                });
        });

    </script>
</body>
</html>
