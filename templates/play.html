{% extends 'base.html' %}
{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" dir="{% if LANGUAGE_BIDI %}rtl{% else %}ltr{% endif %}">
<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow"> <!-- اجازه ایندکس و دنبال کردن لینک‌ها -->
    <title>{% block title %}{% trans 'شروع' %}{% endblock %}</title> <!-- عنوان صفحه -->



</head>
<body>

 {% block content %}

     <div id="cautionTape" class="yellow-tape">
      <img id="tapeImage" class="img-responsive" src="{% static 'images/caution.png' %}" alt="">
  </div>

{% endblock %}

{% block footer_buttons %}

    <div class="container-fluid footer-buttons-centered">
        <a onclick="runAnimation()" class="btn my-2">
            <span class="mt-3">{% trans "شروع تحقیقات" %}</span>
        </a>
    </div>

    <script>

    document.addEventListener('DOMContentLoaded', function () {

    function runAnimation() {
        const cautionTape = document.getElementById('cautionTape');
        cautionTape.classList.add('animate-out');

        cautionTape.addEventListener("animationend", async () => {
            const response = await fetch("{% url 'play:caseplay-list' %}", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
            });

            if (response.ok) {
                window.location.href = "{% url 'product:start-view' case.id %}"; // لینک صفحه مقصد
            } else {
                const errorData = await response.json();
                alert('پرونده معتبر نیست');
                console.error(errorData.detail || response.statusText);
            }
        });
    }

    window.runAnimation = runAnimation; // تعریف تابع در فضای عمومی
});


    </script>


{% endblock %}


</body>
</html>